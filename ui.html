<textarea></textarea>
<script>
    onmessage = event => {
        if(event.data.pluginMessage.copiedText){
            let textarea = document.getElementsByTagName("textarea")[0];
            let copiedText = event.data.pluginMessage.copiedText;
            textarea.value = copiedText;
            textarea.select();
            document.execCommand("copy");
            parent.postMessage({ pluginMessage: { quit: true, text: copiedText } }, '*');
        }

        if(event.data.pluginMessage.paste){
            let textarea = document.getElementsByTagName("textarea")[0];
            textarea.focus();
            document.execCommand("paste");
            let pasteText = textarea.value ? textarea.value : null
            parent.postMessage({ pluginMessage: { pasteTextValue: pasteText } }, '*');
        }
    }
</script>