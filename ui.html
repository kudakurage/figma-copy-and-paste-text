<textarea></textarea>
<script>
    onmessage = event => {
        if(event.data.pluginMessage.copiedText){
            var textarea = document.getElementsByTagName("textarea")[0];
            textarea.value = event.data.pluginMessage.copiedText;
            textarea.select();
            document.execCommand("copy");
            parent.postMessage({ pluginMessage: { quit: true } }, '*');
        }

        if(event.data.pluginMessage.paste){
            var textarea = document.getElementsByTagName("textarea")[0];
            textarea.focus();
            document.execCommand("paste");
            parent.postMessage({ pluginMessage: { pasteTextValue: textarea.value } }, '*');
        }
    }
</script>